#!/usr/bin/env node
(function(jscl){
'use strict';
(function(values, internals){
var l1=internals.make_lisp_string('loading repl-node/repl.lisp!');
console.log(internals.xstring(l1));
var l2=internals.intern('*RL*');
l2;
var l3=internals.intern('START-REPL');
var l4=internals.intern('WELCOME-MESSAGE');
var l5=internals.intern('*ROOT*');
var l6=internals.intern('NIL','COMMON-LISP');
var l7=internals.intern('MAKE-STRING-OUTPUT-STREAM','COMMON-LISP');
var l8=internals.intern('*PACKAGE*','COMMON-LISP');
var l9=internals.intern('PACKAGE-NAME-FOR-PROMPT');
var l10=internals.intern('FORMAT-ERROR');
var l11=internals.intern('COMPLAINT','KEYWORD');
l11.value=l11;
var l12=internals.make_lisp_string('Required argument missing');
var l13=internals.intern('CONTROL-STRING','KEYWORD');
l13.value=l13;
var l14=internals.make_lisp_string('~a> ');
var l15=internals.intern('OFFSET','KEYWORD');
l15.value=l15;
var l16=internals.intern('ERROR','COMMON-LISP');
var l17=internals.intern('PRINC','COMMON-LISP');
var l18=internals.make_lisp_string('> ');
var l19=internals.intern('WRITE-STRING','COMMON-LISP');
var l20=internals.intern('CALL-FORMATTER');
var l21=internals.make_lisp_string('> ');
var l22=internals.intern('LENGTH','COMMON-LISP');
var l23=internals.intern('1+','COMMON-LISP');
var l24=internals.intern('INITIAL-ELEMENT','KEYWORD');
l24.value=l24;
var l25=internals.intern('MAKE-STRING','COMMON-LISP');
var l26=internals.make_lisp_string(' ');
var l27=internals.intern('CONCAT');
var l28=internals.make_lisp_string('line');
var l29=internals.intern('WRITE-LINE','COMMON-LISP');
var l30=internals.intern('STREAM-DATA');
var l31=internals.intern('%SEXPR-INCOMPLETE');
var l32=internals.intern('T','COMMON-LISP');
var l33=internals.make_lisp_string('ERROR[!]: ~a~%');
var l34=internals.make_lisp_string('ERROR[!]: ');
var l35=internals.intern('TERPRI','COMMON-LISP');
var l36=internals.intern('*HANDLER-BINDINGS*');
var l37=internals.intern('%%ERROR');
var l38=internals.intern('LIST','COMMON-LISP');
var l39=internals.intern('EVAL-INTERACTIVE-INPUT');
var l40=internals.intern('FRESH-LINE','COMMON-LISP');
var l41=internals.intern('PRIN1','COMMON-LISP');
var l42=internals.make_lisp_string('~A: ~A');
var l43=internals.make_lisp_string(': ');
var l44=internals.intern('CLASS-OF','COMMON-LISP');
var l45=internals.intern('CLASS-NAME','COMMON-LISP');
var l46=internals.intern('SET-FILL-POINTER');
var l47=internals.make_lisp_string('ERROR[!]: ');
var l48=internals.make_lisp_string(': ');
l3.fvalue=(function(){var FUNC=(function JSCL_USER_STARTREPL(values){internals.checkArgsAtMost(arguments.length-1,0);
var v1=this;
return (function(){l4.fvalue(internals.pv);
l2.value=internals.js_to_lisp(internals.symbolValue(l5)['readline']['createInterface'](internals.lisp_to_js(internals.js_to_lisp((function(){var TMP=internals.symbolValue(l5)['process'];
if (TMP===undefined) return l6.value;
TMP=TMP['stdin'];
return TMP===undefined?l6.value:TMP;
})())),internals.lisp_to_js(internals.js_to_lisp((function(){var TMP=internals.symbolValue(l5)['process'];
if (TMP===undefined) return l6.value;
TMP=TMP['stdout'];
return TMP===undefined?l6.value:TMP;
})()))));
return (function(v3,v4){return (function(v18){v18(internals.pv);
internals.js_to_lisp(internals.symbolValue(l2)['prompt']());
return internals.js_to_lisp(internals.symbolValue(l2)['on'](internals.lisp_to_js(l28),internals.lisp_to_js((function JSCL_USER_NIL(values,v57){internals.checkArgs(arguments.length-1,1);
var v58=this;
l29.fvalue(internals.pv,v57,v3);
(function(v59){return l31.fvalue(internals.pv,v59)!==l6.value?internals.js_to_lisp(internals.symbolValue(l2)['setPrompt'](internals.lisp_to_js(v4))):((function(){try{return (function(){try{var v68=[];
return (function(v69){return (function(){var v70=1;
var v71=[];
TBLOOP:while (true){try{switch(v70){case 1:(function(v72){return internals.bindSpecialBindings([l36],[v72],(function(){(function(){var v74=new internals.Cons(l16,(function JSCL_USER_NIL(values,v75){internals.checkArgs(arguments.length-1,1);
var v76=this;
v69=v75;
return (function(){throw new internals.TagNLX(v71,2);
})();
}));
var v77=new internals.Cons(v74,internals.symbolValue(l36));
return l36.value=v77;
})();
return (function(){try{return (function(){throw new internals.BlockNLX(v68,(function(){return (function(v81,v82){(function(){while (v81!==l6.value){v82=v81['$$jscl_car'];
l40.fvalue(internals.pv);
l41.fvalue(internals.pv,v82);
l35.fvalue(internals.pv);
l6.value;
v81=v81['$$jscl_cdr'];
}return l6.value;
})();
return l6.value;
})((function(){var FUNC=internals.symbolFunction(l38);
var ARGS=[internals.pv];
return (function(){var values=internals.mv;
var VS;
VS=l39.fvalue(values,v59);
if (typeof VS==='object'&&VS&&'multiple-value' in VS) ARGS=ARGS.concat(VS);
 else ARGS.push(VS);
return FUNC.apply(null,ARGS);
})();
})(),l6.value);
})(),'G201');
})();
}catch (v78){v78=internals.js_to_lisp(v78);
return (internals.isNLX(v78)?l32.value:l6.value)!==l6.value?(function(){throw v78;
})():l37.fvalue(internals.pv,(function(v79){return v79!==l6.value?v79:v78;
})(internals.js_to_lisp((function(){var TMP=v78['message'];
return TMP===undefined?l6.value:TMP;
})())));
}})();
}));
})(internals.symbolValue(l36));
case 2:(function(){throw new internals.BlockNLX(v68,(function(v83){l20.fvalue(internals.pv,l32.value,(function JSCL_USER_NIL(values,v85,v86,v87){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v86=l16.fvalue(internals.pv,l10,l11.value,l12,l13.value,l42,l15.value,1);
;
case 2:v87=l16.fvalue(internals.pv,l10,l11.value,l12,l13.value,l42,l15.value,5);
;
default:break;
}var v84=l6.value;
var I;
for (I=arguments.length-1-1;I>=3;I--)v84=new internals.Cons(arguments[I+1],v84);
var v88=this;
(function(){l17.fvalue(internals.pv,v86,v85);
l19.fvalue(internals.pv,l48,v85);
return l17.fvalue(internals.pv,v87,v85);
})();
return v84;
}),l45.fvalue(internals.pv,l44.fvalue(internals.pv,v83)),v83);
return l35.fvalue(internals.pv);
})(v69),'G201');
})();
default:break TBLOOP;
}}catch (JUMP){if (JUMP instanceof internals.TagNLX&&JUMP.id==v71) v70=JUMP.label;
 else throw JUMP;
}}return l6.value;
})();
})(l6.value);
}catch (CF){if (CF instanceof internals.BlockNLX&&CF.id==v68) return CF.values;
 else throw CF;
}})();
}catch (v60){v60=internals.js_to_lisp(v60);
return (function(v62){return l20.fvalue(internals.pv,l32.value,(function JSCL_USER_NIL(values,v64,v65){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v65=l16.fvalue(internals.pv,l10,l11.value,l12,l13.value,l33,l15.value,11);
;
default:break;
}var v63=l6.value;
var I;
for (I=arguments.length-1-1;I>=2;I--)v63=new internals.Cons(arguments[I+1],v63);
var v66=this;
(function(){l19.fvalue(internals.pv,l47,v64);
l17.fvalue(internals.pv,v65,v64);
return l35.fvalue(internals.pv,v64);
})();
return v63;
}),v62);
})((function(v61){return v61!==l6.value?v61:v60;
})(internals.js_to_lisp((function(){var TMP=v60['message'];
return TMP===undefined?l6.value:TMP;
})())));
}})(),(function(){var v91=l30.fvalue(internals.pv,v3);
return (function(){var FUNC=(function JSCL_USER_NIL(values,v93){switch(arguments.length-1){case 0:v93=l6.value;
;
default:break;
}var v92=l6.value;
var I;
for (I=arguments.length-1-1;I>=1;I--)v92=new internals.Cons(arguments[I+1],v92);
var v94=this;
return l46.fvalue(values,v91,v93);
});
var ARGS=[internals.pv];
return (function(){var values=internals.mv;
var VS;
VS=0;
if (typeof VS==='object'&&VS&&'multiple-value' in VS) ARGS=ARGS.concat(VS);
 else ARGS.push(VS);
return FUNC.apply(null,ARGS);
})();
})();
})(),v18(internals.pv));
})(l30.fvalue(internals.pv,v3));
return internals.js_to_lisp(internals.symbolValue(l2)['prompt']());
}))));
})((function JSCL_USER_NIL(values){internals.checkArgsAtMost(arguments.length-1,0);
var v5=this;
return (function(){return (function(v7){internals.js_to_lisp(internals.symbolValue(l2)['setPrompt'](internals.lisp_to_js(l20.fvalue(internals.pv,l6.value,(function JSCL_USER_NIL(values,v14,v15){internals.checkArgsAtLeast(arguments.length-1,1);
switch(arguments.length-1){case 1:v15=l16.fvalue(internals.pv,l10,l11.value,l12,l13.value,l14,l15.value,1);
;
default:break;
}var v13=l6.value;
var I;
for (I=arguments.length-1-1;I>=2;I--)v13=new internals.Cons(arguments[I+1],v13);
var v16=this;
(function(){l17.fvalue(internals.pv,v15,v14);
return l19.fvalue(internals.pv,l21,v14);
})();
return v13;
}),v7))));
return v4=l27.fvalue(internals.pv,l25.fvalue(internals.pv,l23.fvalue(internals.pv,l22.fvalue(internals.pv,v7)),l24.value,'.'),l26);
})(l9.fvalue(internals.pv,internals.symbolValue(l8)));
})();
}));
})(l7.fvalue(internals.pv),l6.value);
})();
});
FUNC.fname='START-REPL';
return FUNC;
})();
l3;
var l49=internals.intern('NODE-INIT');
var l50=internals.intern('*STANDARD-OUTPUT*','COMMON-LISP');
var l51=internals.intern('WRITE-FN','KEYWORD');
l51.value=l51;
var l52=internals.intern('MAKE-STREAM');
var l53=internals.intern('*ERROR-OUTPUT*','COMMON-LISP');
var l54=internals.intern('*TRACE-OUTPUT*','COMMON-LISP');
var l55=internals.intern('JS-TO-LISP');
var l56=internals.intern('SUBSEQ','COMMON-LISP');
var l57=internals.intern('VECTOR-TO-LIST');
var l58=internals.intern('MAPCAR','COMMON-LISP');
var l59=internals.intern('NULL','COMMON-LISP');
var l60=internals.intern('LOAD','COMMON-LISP');
l49.fvalue=(function(){var FUNC=(function JSCL_USER_NODEINIT(values){internals.checkArgsAtMost(arguments.length-1,0);
var v95=this;
return (function(){l50.value=l52.fvalue(internals.pv,l51.value,(function JSCL_USER_NIL(values,v97){internals.checkArgs(arguments.length-1,1);
var v98=this;
return internals.js_to_lisp(internals.symbolValue(l5)['process']['stdout']['write'](internals.lisp_to_js(v97)));
}));
l53.value=internals.symbolValue(l50);
l54.value=internals.symbolValue(l50);
return (function(v99){return l59.fvalue(internals.pv,v99)!==l6.value?l3.fvalue(values):(function(){return (function(v101,v102){(function(){while (v101!==l6.value){v102=v101['$$jscl_car'];
l60.fvalue(internals.pv,v102);
l6.value;
v101=v101['$$jscl_cdr'];
}return l6.value;
})();
return l6.value;
})(v99,l6.value);
})();
})(l58.fvalue(internals.pv,internals.symbolFunction(l55),l57.fvalue(internals.pv,l56.fvalue(internals.pv,internals.js_to_lisp((function(){var TMP=internals.symbolValue(l5)['process'];
if (TMP===undefined) return l6.value;
TMP=TMP['argv'];
return TMP===undefined?l6.value:TMP;
})()),2))));
})();
});
FUNC.fname='NODE-INIT';
return FUNC;
})();
l49;
l49.fvalue(internals.pv);
})(jscl.internals.pv, jscl.internals);
})( typeof require !== 'undefined'? require('./jscl'): window.jscl )
